import { c as create_ssr_component, d as createEventDispatcher, e as escape, b as add_attribute, a as subscribe, v as validate_component, f as each } from "../../../../chunks/ssr.js";
import "../../../../chunks/firebase.js";
import { t } from "../../../../chunks/i18n.js";
import { N as Nav } from "../../../../chunks/Nav.js";
const css$1 = {
  code: ".modal-overlay.svelte-1n6uj9{background-color:rgba(0,0,0,.5)}",
  map: `{"version":3,"file":"NegotiationModal.svelte","sources":["NegotiationModal.svelte"],"sourcesContent":["<!-- src/lib/components/NegotiationModal.svelte -->\\r\\n<script>\\r\\n    import { createEventDispatcher } from 'svelte';\\r\\n\\r\\n    export let product = {}; // Passed product details\\r\\n    export let showModal = false; // Control visibility of the modal\\r\\n\\r\\n    let negotiationPrice = ''; // Store the negotiation price input\\r\\n\\r\\n    const dispatch = createEventDispatcher();\\r\\n\\r\\n    // Function to handle negotiation\\r\\n    function handleNegotiate() {\\r\\n        if (negotiationPrice) {\\r\\n            const negotiatedProduct = {\\r\\n                ...product,\\r\\n                negotiationPrice\\r\\n            };\\r\\n            dispatch('negotiate', negotiatedProduct); // Dispatch an event with negotiated product data\\r\\n            negotiationPrice = ''; // Clear the input field\\r\\n            showModal = false; // Close the modal\\r\\n        }\\r\\n    }\\r\\n\\r\\n    // Function to close the modal\\r\\n    function closeModal() {\\r\\n        showModal = false;\\r\\n    }\\r\\n<\/script>\\r\\n\\r\\n{#if showModal}\\r\\n<div class=\\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\\">\\r\\n    <div class=\\"bg-white rounded-lg shadow-lg p-5 w-11/12 md:w-1/3 modal-overlay\\">\\r\\n        <h2 class=\\"text-xl font-semibold mb-4 text-white text-opacity-[50%]\\">Negotiate Price for {product.name}</h2>\\r\\n        <input \\r\\n            type=\\"number\\" \\r\\n            placeholder=\\"Enter your price\\" \\r\\n            bind:value={negotiationPrice} \\r\\n            class=\\"p-2 w-full border rounded-md mb-4\\"\\r\\n        />\\r\\n        <div class=\\"flex justify-end\\">\\r\\n            <button class=\\"bg-gray-300 px-4 py-2 mr-2 rounded-md\\" on:click={closeModal}>Cancel</button>\\r\\n            <button class=\\"bg-green-500 text-white px-4 py-2 rounded-md\\" on:click={handleNegotiate}>Negotiate</button>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n{/if}\\r\\n\\r\\n<style>.modal-overlay{background-color:rgba(0,0,0,.5)}</style>\\r\\n"],"names":[],"mappings":"AAgDO,4BAAc,CAAC,iBAAiB,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC"}`
};
const NegotiationModal = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let { product = {} } = $$props;
  let { showModal = false } = $$props;
  let negotiationPrice = "";
  createEventDispatcher();
  if ($$props.product === void 0 && $$bindings.product && product !== void 0) $$bindings.product(product);
  if ($$props.showModal === void 0 && $$bindings.showModal && showModal !== void 0) $$bindings.showModal(showModal);
  $$result.css.add(css$1);
  return `  ${showModal ? `<div class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"><div class="bg-white rounded-lg shadow-lg p-5 w-11/12 md:w-1/3 modal-overlay svelte-1n6uj9"><h2 class="text-xl font-semibold mb-4 text-white text-opacity-[50%]">Negotiate Price for ${escape(product.name)}</h2> <input type="number" placeholder="Enter your price" class="p-2 w-full border rounded-md mb-4"${add_attribute("value", negotiationPrice, 0)}> <div class="flex justify-end"><button class="bg-gray-300 px-4 py-2 mr-2 rounded-md" data-svelte-h="svelte-hci8xb">Cancel</button> <button class="bg-green-500 text-white px-4 py-2 rounded-md" data-svelte-h="svelte-1q3p9o1">Negotiate</button></div></div></div>` : ``}`;
});
const css = {
  code: ".loader.svelte-sg8bjj{animation:svelte-sg8bjj-spin 1s linear infinite;border:4px solid rgba(0,0,0,.1);border-radius:50%;border-top-color:#3498db;height:40px;margin:0 auto;width:40px}@keyframes svelte-sg8bjj-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}",
  map: `{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script>\\r\\n    import { onMount } from 'svelte';\\r\\n    import { fetchProducts } from '$lib/actions/firebase.js';\\r\\n    import { t } from '$lib/i18n';\\r\\n    import Button from '$lib/component/landing/components/Button.svelte';\\r\\n    import Nav from '$lib/component/landing/Nav.svelte';\\r\\n    import NegotiationModal from '$lib/component/NegotiationModal.svelte'; // Import the NegotiationModal component\\r\\n\\r\\n    let products = [];\\r\\n    let isLoading = true;\\r\\n    let searchQuery = ''; // Search query binding\\r\\n    let selectedProductType = ''; // To store selected product type from dropdown\\r\\n    let filteredProducts = []; // To hold filtered products\\r\\n    let showModal = false; // Modal visibility\\r\\n    let currentProduct = {}; // Product currently being negotiated\\r\\n    let negotiatedProducts = []; // Store negotiated products\\r\\n\\r\\n    // Fetch products from Firebase on component mount\\r\\n    onMount(() => {\\r\\n        fetchProducts((fetchedProducts) => {\\r\\n            products = fetchedProducts;\\r\\n            isLoading = false; // Stop loading when data is fetched\\r\\n            filterProducts(); // Initial filtering\\r\\n            console.log('Fetched products:', products);\\r\\n        });\\r\\n    });\\r\\n\\r\\n    // Reactive statement to filter products based on searchQuery and selectedProductType\\r\\n    $: filterProducts = () => {\\r\\n        filteredProducts = products.filter(product => {\\r\\n            const matchesSearchQuery = product.name.toLowerCase().includes(searchQuery.toLowerCase());\\r\\n            const matchesSelectedType = selectedProductType ? product.name.toLowerCase() === selectedProductType.toLowerCase() : true;\\r\\n            return matchesSearchQuery && matchesSelectedType;\\r\\n        });\\r\\n    };\\r\\n\\r\\n    // Function to open negotiation modal for a specific product\\r\\n    function openNegotiationModal(product) {\\r\\n        currentProduct = product;\\r\\n        showModal = true;\\r\\n    }\\r\\n\\r\\n    // Function to handle negotiated product\\r\\n    function handleNegotiatedProduct(event) {\\r\\n        negotiatedProducts = [...negotiatedProducts, event.detail];\\r\\n    }\\r\\n<\/script>\\r\\n\\r\\n<div class=\\"container mx-auto py-10 bg-gradient-to-r from-indigo-500 to-blue-500\\">\\r\\n    <Nav/>\\r\\n    <br><br><br><br>\\r\\n    <h1 class=\\"text-3xl font-bold text-center mb-5 text-white\\">{$t(\\"itl\\")}</h1>\\r\\n    \\r\\n    <!-- Search Input -->\\r\\n    <div class=\\"text-center mb-5\\">\\r\\n        <input \\r\\n            type=\\"text\\" \\r\\n            placeholder=\\"Search for products...\\" \\r\\n            bind:value={searchQuery}\\r\\n            class=\\"p-2 rounded-lg border border-gray-300 w-2/3 md:w-1/3\\"\\r\\n            on:input={filterProducts}\\r\\n        />\\r\\n    </div>\\r\\n\\r\\n    <!-- Select Dropdown for Product Types -->\\r\\n    <div class=\\"text-center mb-5\\">\\r\\n        <select \\r\\n            bind:value={selectedProductType} \\r\\n            class=\\"p-2 rounded-lg border border-gray-300 w-2/3 md:w-1/3\\"\\r\\n            on:change={filterProducts}\\r\\n        >\\r\\n            <option value=\\"\\">All Products</option>\\r\\n            <option value=\\"apples\\">Apples</option>\\r\\n            <option value=\\"mangos\\">Mangos</option>\\r\\n            <option value=\\"green grapes\\">Green Grapes</option>\\r\\n            <option value=\\"dark grapes\\">Dark Grape</option>\\r\\n            <option value=\\"water melon\\">Watermelon</option>\\r\\n        </select>\\r\\n    </div>\\r\\n\\r\\n    {#if isLoading}\\r\\n        <div class=\\"text-center py-20\\">\\r\\n            <div class=\\"loader\\">Loading...</div>\\r\\n        </div>\\r\\n    {:else}\\r\\n        <div class=\\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\\">\\r\\n            {#if filteredProducts.length}\\r\\n                {#each filteredProducts as product}\\r\\n                    <div class=\\"bg-white shadow-md rounded-lg overflow-hidden p-2\\">\\r\\n                        <img src={product.imageUrl || 'placeholder-image-url.jpg'} alt={product.name} class=\\"w-full h-60 object-cover\\">\\r\\n                        <div class=\\"p-4\\">\\r\\n                            <h2 class=\\"text-lg font-semibold\\">{product.name}</h2>\\r\\n                            <p class=\\"text-gray-500\\">Price: â‚¹{product.price}</p>\\r\\n                            <p class=\\"text-gray-500\\">{product.kg} Kg</p>\\r\\n                            <p class=\\"text-gray-400 text-sm\\">ID: {product.id}</p>\\r\\n                            <p class=\\"text-gray-400 text-sm\\">Date: {product.date}</p>\\r\\n                            <button  on:click={() => openNegotiationModal(product)}><Button green>Buy</Button></button>\\r\\n                        </div>\\r\\n                    </div>\\r\\n                {/each}\\r\\n            {:else}\\r\\n                <p class=\\"text-center text-gray-500\\">No products found.</p>\\r\\n            {/if}\\r\\n        </div>\\r\\n    {/if}\\r\\n\\r\\n    <!-- Negotiation Modal Component -->\\r\\n    <NegotiationModal\\r\\n        bind:showModal={showModal}\\r\\n        product={currentProduct}\\r\\n        on:negotiate={handleNegotiatedProduct}\\r\\n    />\\r\\n\\r\\n    <!-- List of Negotiated Products -->\\r\\n    {#if negotiatedProducts.length}\\r\\n        <div class=\\"bg-white shadow-md rounded-lg mt-10 p-5\\">\\r\\n            <h2 class=\\"text-xl font-semibold mb-4\\">Negotiated Products</h2>\\r\\n            <ul>\\r\\n                {#each negotiatedProducts as product}\\r\\n                    <li class=\\"mb-2\\">\\r\\n                        {product.name} - Original Price: â‚¹{product.price}, Negotiated Price: â‚¹{product.negotiationPrice}\\r\\n                    </li>\\r\\n                {/each}\\r\\n            </ul>\\r\\n        </div>\\r\\n    {/if}\\r\\n</div>\\r\\n\\r\\n<style>.loader{animation:spin 1s linear infinite;border:4px solid rgba(0,0,0,.1);border-radius:50%;border-top-color:#3498db;height:40px;margin:0 auto;width:40px}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}</style>\\r\\n"],"names":[],"mappings":"AAgIO,qBAAO,CAAC,UAAU,kBAAI,CAAC,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,cAAc,GAAG,CAAC,iBAAiB,OAAO,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,WAAW,kBAAI,CAAC,EAAE,CAAC,UAAU,OAAO,IAAI,CAAC,CAAC,EAAE,CAAC,UAAU,OAAO,KAAK,CAAC,CAAC"}`
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let $t, $$unsubscribe_t;
  $$unsubscribe_t = subscribe(t, (value) => $t = value);
  let searchQuery = "";
  let showModal = false;
  let currentProduct = {};
  let negotiatedProducts = [];
  $$result.css.add(css);
  let $$settled;
  let $$rendered;
  let previous_head = $$result.head;
  do {
    $$settled = true;
    $$result.head = previous_head;
    $$rendered = `<div class="container mx-auto py-10 bg-gradient-to-r from-indigo-500 to-blue-500">${validate_component(Nav, "Nav").$$render($$result, {}, {}, {})} <br><br><br><br> <h1 class="text-3xl font-bold text-center mb-5 text-white">${escape($t("itl"))}</h1>  <div class="text-center mb-5"><input type="text" placeholder="Search for products..." class="p-2 rounded-lg border border-gray-300 w-2/3 md:w-1/3"${add_attribute("value", searchQuery, 0)}></div>  <div class="text-center mb-5"><select class="p-2 rounded-lg border border-gray-300 w-2/3 md:w-1/3"><option value="" data-svelte-h="svelte-18kixnx">All Products</option><option value="apples" data-svelte-h="svelte-stvu7e">Apples</option><option value="mangos" data-svelte-h="svelte-neeac2">Mangos</option><option value="green grapes" data-svelte-h="svelte-1a3hiiu">Green Grapes</option><option value="dark grapes" data-svelte-h="svelte-87hsz7">Dark Grape</option><option value="water melon" data-svelte-h="svelte-16zjzru">Watermelon</option></select></div> ${`<div class="text-center py-20" data-svelte-h="svelte-aoxmif"><div class="loader svelte-sg8bjj">Loading...</div></div>`}  ${validate_component(NegotiationModal, "NegotiationModal").$$render(
      $$result,
      { product: currentProduct, showModal },
      {
        showModal: ($$value) => {
          showModal = $$value;
          $$settled = false;
        }
      },
      {}
    )}  ${negotiatedProducts.length ? `<div class="bg-white shadow-md rounded-lg mt-10 p-5"><h2 class="text-xl font-semibold mb-4" data-svelte-h="svelte-1m0ra1s">Negotiated Products</h2> <ul>${each(negotiatedProducts, (product) => {
      return `<li class="mb-2">${escape(product.name)} - Original Price: â‚¹${escape(product.price)}, Negotiated Price: â‚¹${escape(product.negotiationPrice)} </li>`;
    })}</ul></div>` : ``} </div>`;
  } while (!$$settled);
  $$unsubscribe_t();
  return $$rendered;
});
export {
  Page as default
};
